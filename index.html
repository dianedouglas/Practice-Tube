<!doctype html>
<html>
<head>
  <title>Google I/O YouTube Codelab</title>
  <link type="text/css" rel="stylesheet" href="index.css">
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="//www.google.com/jsapi"></script>
  <script type="text/javascript" src="index.js"></script>
  <script type="text/javascript" src="https://apis.google.com/js/client.js?onload=onJSClientLoad"></script>
</head>
<body>
  <div id="login-container" class="pre-auth">In order to search videos, this app needs you to login to your YouTube account. I promise I won't do anything with your information, ok?
    Please <a href="#" id="login-link">authorize</a> to continue.
  </div>
  <div class="post-auth">
    <iframe id="existing-iframe-example"
            width="640" height="360"
            src="https://www.youtube.com/embed/_SBQvd6vY9s?enablejsapi=1"
            frameborder="0"
            style="border: solid 4px #37474F"
    ></iframe>
    <button onclick="getLoopStartTime()">Start Loop</button>
    <button onclick="getLoopEndTime()">End Loop</button>
    <button onclick="startLooping()">Looping Go!</button>
    <button onclick="resumePlayback()">Resume Playback</button>
    <button onclick="back10()">Back 10 Seconds</button>
    <button onclick="back20()">Back 20 Seconds</button>
    <button onclick="back30()">Back 30 Seconds</button>
    <button onclick="back60()">Back 60 Seconds</button>
    <button onclick="halfSpeed()">Wait! Slow Down! (AKA Half Speed)</button>
    <button onclick="normalSpeed()">OK I got it! (AKA Normal Speed)</button>
    <input id="find-videos" type="text">
    <button id="search" type="submit">Go</button>
    <div id="results"></div>
    <div id="pager"></div>
  </div>
  <script type="text/javascript">
    var tag = document.createElement('script');
    tag.id = 'iframe-demo';
    tag.src = 'https://www.youtube.com/iframe_api';
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;
    var videoId = "YxgsxaFWWHQ";
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('existing-iframe-example', {
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
      });
    }
    function loadVideoById(id) {
      player.cueVideoById({'videoId': id});
      player.playVideo();
    }
    var endTime;
    var startTime;
    function getLoopStartTime() {
      startTime = player.getCurrentTime();
    }
    function getLoopEndTime() {
      endTime = player.getCurrentTime();
      startLooping();
    }
    function startLooping() {
      var currentVideoId = player.getVideoData()['video_id'];
      player.cueVideoById({'videoId': currentVideoId,
        'startSeconds': startTime,
        'endSeconds': endTime});
      player.playVideo();
    }
    function resumePlayback() {
      var duration = player.getDuration();
      var currentTime = player.getCurrentTime();
      var currentVideoId = player.getVideoData()['video_id'];
      player.cueVideoById({'videoId': currentVideoId,
        'startSeconds': currentTime,
        'endSeconds': duration});
      player.playVideo();
    }
    function back10() {
      var currentTime = player.getCurrentTime();
      player.seekTo(currentTime - 10);
    }
    function back20() {
      var currentTime = player.getCurrentTime();
      player.seekTo(currentTime - 20);
    }
    function back30() {
      var currentTime = player.getCurrentTime();
      player.seekTo(currentTime - 30);
    }
    function back60() {
      var currentTime = player.getCurrentTime();
      player.seekTo(currentTime - 60);
    }
    function onPlayerReady(event) {
      document.getElementById('existing-iframe-example').style.borderColor = '#FF6D00';
    }
    function onPlayerStateChange(event) {
      if (event.data == 0) {
        startLooping();
      }
    }
    function halfSpeed(){
      player.setPlaybackRate('.5');
    }
    function normalSpeed(){
      player.setPlaybackRate('1');
    }
  </script>
</body>
</html>