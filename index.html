<!doctype html>
<html>
<head>
  <title>Google I/O YouTube Codelab</title>
  <link type="text/css" rel="stylesheet" href="index.css">
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="//www.google.com/jsapi"></script>
  <script type="text/javascript" src="index.js"></script>
  <script type="text/javascript" src="https://apis.google.com/js/client.js?onload=onJSClientLoad"></script>
</head>
<body>
  <div id="login-container" class="pre-auth">This application requires access to your YouTube account.
    Please <a href="#" id="login-link">authorize</a> to continue.
  </div>
  <div class="post-auth">
    <div id="message"></div>
    <div id="chart"></div>
    <div>Choose a Video:</div>
    <ul id="video-list"></ul>
  </div>
  <button onclick="loadVideoById()">Load</button>
  <button onclick="getLoopStartTime()">Start Loop</button>
  <button onclick="getLoopEndTime()">End Loop</button>
  <button onclick="startLooping()">Looping Go!</button>
  <iframe id="existing-iframe-example"
          width="640" height="360"
          src="https://www.youtube.com/embed/_SBQvd6vY9s?enablejsapi=1"
          frameborder="0"
          style="border: solid 4px #37474F"
  ></iframe>

  <script type="text/javascript">
    var tag = document.createElement('script');
    tag.id = 'iframe-demo';
    tag.src = 'https://www.youtube.com/iframe_api';
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;
    var videoId = "YxgsxaFWWHQ";
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('existing-iframe-example', {
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
      });
    }
    function loadVideoById() {
      player.cueVideoById({'videoId': videoId});
      player.playVideo();

    }
    var endTime;
    var startTime;
    function getLoopStartTime() {
      startTime = player.getCurrentTime();
    }
    function getLoopEndTime() {
      endTime = player.getCurrentTime();
    }
    function startLooping() {
      player.cueVideoById({'videoId': videoId,
        'startSeconds': startTime,
        'endSeconds': endTime});
      player.playVideo();
    }
    function onPlayerStateChange(event) {
      if (event.data == 0) {
        startLooping();
      };
    }
  </script>
</body>
</html>